\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{todonotes}
\usepackage{amssymb,amsmath}


\input defs.tex

\title{notes on duality}
\author{AJ Friend}
\date{\today}

\begin{document}

\maketitle

\section{Convex conjugate}
Consult \cite{boyd2009convex} for background on duality.
The definition of the conjugate function is
\[
f^*(y) = \sup_{x \in \dom f} \left( y^T x - f(x) \right).
\]

\paragraph{Alternative representation}
Note that if we see the conjugate as the optimal value of an optimization
problem, then we get the equivalence
\[
y = \nabla f(x) \iff f^*(y) = y^T x - f(x) = \nabla f(x)^T x - f(x).
\]
This equivalence provides a duality.
We can
\begin{itemize}
\item generate (uncontrolled) points of the $f^*$ by plugging (controlled) $x$
values into $\nabla f$, and
\item determine $f^*(y)$ by solving the gradient equation $y = \nabla f(x)$.
\end{itemize}
\todo[inline]{If $f^{**} = f$, then we can go both ways.}

\paragraph{Fenchelâ€™s inequality} The inequality follows from the definition:
\[
f(x) + f^*(y) \geq x^T y
\]
Note that equality occurs when $y = \nabla f(x)$.

\section{Duality}
A primal problem has the form
\[
\begin{array}{ll}
\mbox{minimize} & f(x)\\
\mbox{subject to} & Ax = b\\
& x \geq 0.
\end{array}
\]

The dual problem has the form
\[
\begin{array}{ll}
\mbox{maximize} & -f^*(\tau - A^T \lambda) - b^T \lambda \\
\mbox{subject to} & \tau \geq 0
\end{array}
\]

\paragraph{Optimality conditions}
The optimality conditions are given by
\begin{align*}
A x &= b \\
x &\geq 0 \\
\tau &\geq 0 \\
f(x) + f^*(\tau - A^T \lambda) + b^T \lambda &\leq 0,
\end{align*}
where the first three conditions are primal and dual feasibility,
and the last condition is an upper bound on the duality gap.
(Since the duality gap is always nonnegative for a feasible pair,
this last condition implies zero duality gap.)
Implicitly, we assume the same constraints as on the domains of $f$ and $f^*$.

\paragraph{Zero duality gap}
To see the zero duality gap condition algebraically, recall Fenchel's inequality.
We have that
\[
f(x) + f^*(\tau - A^T \lambda) + b^T\lambda \geq x^T (\tau - A^T \lambda) + b^T\lambda
= x^T \tau \geq 0,
\]
which implies equality, and, in particular, the complementarity condition
$x^T \tau = 0$.
The equality triggers the equality condition in the Fenchel inequality, which
means that $\tau - A^T \lambda = \nabla f(x)$.
These two conditions give us
exactly the KKT conditions for the problem.
The next section shows this result in another (but essentially the same) way.

\paragraph{Equivalence with KKT conditions}
The optimality conditions given above are equivalent to the standard KKT
conditions. To see this, note that since, via the above constraints,
$\tau - A^T \lambda \in \dom f^*$, so there is some $x$ such that

\begin{align*}
\nabla f(x) &= \tau - A^T \lambda \\
f^*(\tau - A^T \lambda) &= \left( \tau - A^T \lambda \right)^T x - f(x).
\end{align*}

Adding the first condition and substituting the second into the optimality
conditions above gives us the usual KKT conditions:

\begin{align*}
A x &= b \\
x &\geq 0 \\
\tau &\geq 0 \\
\tau - A^T \lambda &= \nabla f(x)\\
\tau^T x &= 0.
\end{align*}

\todo[inline]{Now, we'll show the other direction of the equivalence.}
\todo[inline]{For LP, different forms gives complementarity and zero duality
gap versions of KKT.}
\todo[inline]{The duality of complementarity and duality gap must be baked into
the duality derivation.}
\todo[inline]{Can I make the first version into a convex program by using the
Fenchel inequality to show that the last sum is bounded below by zero?
Of course I can! If not fenchel, then certainly because we are bounding the
the duality gap, so we only want it less than zero!}
\todo[inline]{Can I use this to write Ye's optimality conditions without
gradients of functions?}
\paragraph{Example}
For the function $f(x) = c^T x$, we have the conjugate
$f^*(y) = 0$ if $y=c$ and $f^*(y) = +\infty$ otherwise.
This allows us to recover the usual LP KKT conditions:
\begin{align*}
A x &= b \\
x &\geq 0 \\
\tau &\geq 0 \\
c^T x + b^T \lambda &= 0\\
\tau - A^T \lambda &= c.
\end{align*}
Note that the fourth condition, that the duality gap is zero, can be
re-written as a complementarity condition, since

\begin{align*}
& c^T x + b^T \lambda = 0 \\
\implies& (\tau - A^T \lambda)^T x + b^T \lambda = 0 \\
\implies& \tau^Tx - \lambda^T A x + b^T \lambda = 0 \\
\implies& \tau^Tx - \lambda^T b + b^T \lambda = 0 \\
\implies& \tau^Tx  = 0.
\end{align*}


\newpage
\bibliographystyle{alpha}
\bibliography{bibliography.bib}


\end{document}